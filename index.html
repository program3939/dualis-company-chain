<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dual-Coin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }

        header {
            text-align: center;
            background-color: #4CAF50;
            color: white;
            padding: 10px 0;
        }

        h1, h2 {
            margin: 0;
            color: green; /* Wichtige Schriftfarbe grün */
        }

        section {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        input[type="text"], input[type="password"], input[type="file"] {
            width: 200px;
            padding: 10px;
            margin: 10px 0;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        /* Fehlermeldungen stilisieren */
        .error-message {
            color: red;
            font-weight: bold;
        }

        /* Info-Kasten */
        .info-message {
            color: orange;
            font-weight: bold;
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            input[type="text"], input[type="password"], input[type="file"], button {
                width: 100%;
                margin: 10px 0;
            }

            section {
                padding: 10px;
            }
        }

        /* Diagramm Styling */
        #chart {
            width: 100%;
            height: 300px;
        }

        #profileImage {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            margin: 10px auto;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Chart.js für Diagramm -->
</head>
<body>
    <header>
        <h1>Willkommen bei Dual-Coin</h1>
    </header>

    <main>
        <section id="registration">
            <h2 id="formTitle">Registrierung</h2>
            <p class="info-message">Wir benötigen Ihre Role-Play-Daten, um fortzufahren. Diese Daten müssen Sie sich unbedingt merken:</p>
            <ul>
                <li>E-Mail-Adresse</li>
                <li>Discord-Name</li>
                <li>Passwort</li>
                <li>Profilbild</li>
            </ul>
            <p class="info-message">Diese Informationen sind entscheidend und dürfen nicht vergessen werden. Notieren Sie sie sicher.</p>
            <input type="text" id="email" placeholder="E-Mail-Adresse">
            <input type="text" id="discordName" placeholder="Discord-Name">
            <input type="password" id="password" placeholder="Passwort">
            <input type="file" id="profileImageInput" accept="image/*" onchange="previewImage(event)">
            <img id="profileImage" src="" alt="Profilbild-Vorschau" style="display: none;">
            <button onclick="register()">Registrieren</button>
            <button onclick="toggleForm()">Zu Anmelden wechseln</button> <!-- Button zum Wechseln -->
        </section>

        <section id="interactive-machine" style="display: none;">
            <h2>Interaktiver Automat</h2>
            <input type="text" id="codeInput" maxlength="8" placeholder="Code eingeben">
            <button onclick="submitCode()">Einreichen</button>
            <div id="message" class="error-message"></div>
        </section>

        <section id="price-table">
            <h2>Aktueller Coin-Preis</h2>
            <p id="coinPrice">10.00 €</p>
            <canvas id="chart"></canvas> <!-- Diagramm hier -->
        </section>

        <section id="employee-access" style="display: none;">
            <h2>Mitarbeiterzugang</h2>
            <input type="text" id="username" placeholder="Benutzername">
            <input type="password" id="adminPassword" placeholder="Passwort">
            <button onclick="login()">Einloggen</button>
            <div id="adminPanel" style="display:none;">
                <h3>Admin-Panel</h3>
                <input type="text" id="newCodeInput" maxlength="8" placeholder="Neuen Code generieren">
                <button onclick="addCode()">Code hinzufügen</button>
                <div id="adminMessage" class="error-message"></div>
                <button onclick="sendCoins()">Coins senden</button> <!-- Admin Funktion hinzufügen -->
                <input type="text" id="recipient" placeholder="Empfänger Discord-Name">
                <input type="number" id="amount" placeholder="Menge">
                <button onclick="withdrawCoins()">Coins abheben</button>
            </div>
        </section>

        <section id="settings" style="display: none;">
            <h2>Einstellungen</h2>
            <p>Kontostand: <span id="coinBalance">0</span> Coins</p>
            <p>Kartennummer: <span id="cardNumber">XXXX-XXXX</span></p>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Dual-Coin. Alle Rechte vorbehalten.</p>
    </footer>

    <script>
        let codes = [];
        let coinPrice = 10.00;
        let lastCodeTime = Date.now();
        let coinBalance = 0; // Kontostand der Coins
        let cardNumber = Math.floor(Math.random() * 90000000) + 10000000; // Zufällige 8-stellige Kartennummer

        function toggleForm() {
            const registrationSection = document.getElementById("registration");
            const isRegistering = registrationSection.style.display !== "none";
            registrationSection.style.display = isRegistering ? "none" : "block";
            document.getElementById("interactive-machine").style.display = "none"; // Maschine verstecken
            document.getElementById("formTitle").textContent = isRegistering ? "Anmeldung" : "Registrierung"; // Titel ändern
        }

        function previewImage(event) {
            const image = document.getElementById('profileImage');
            image.src = URL.createObjectURL(event.target.files[0]);
            image.style.display = "block"; // Bild anzeigen
        }

        function register() {
            // Registrierung logik
            document.getElementById("interactive-machine").style.display = "block"; // Maschine sichtbar
            document.getElementById("registration").style.display = "none"; // Registrierung unsichtbar
            document.getElementById("settings").style.display = "block"; // Einstellungen sichtbar
            document.getElementById("cardNumber").textContent = cardNumber; // Kartennummer setzen
        }

        function submitCode() {
            const codeInput = document.getElementById("codeInput").value;
            const message = document.getElementById("message");

            if (codes.includes(codeInput)) {
                codes.push(codeInput);
                lastCodeTime = Date.now();
                coinPrice *= 1.05; // Erhöhung um 5%
                coinBalance++; // Kontostand erhöhen
                updateUI(codeInput);
                message.textContent = "Code erfolgreich eingereicht!";
                message.className = ""; // Fehlerklasse zurücksetzen
                animateCoin(); // Animation für Coin hinzufügen
            } else {
                message.textContent = "Ungültiger Code!";
                message.className = "error-message"; // Fehlerklasse hinzufügen
            }

            document.getElementById("codeInput").value = "";
        }

        function updateUI(code) {
            document.getElementById("coinPrice").textContent = coinPrice.toFixed(2) + " €";
            document.getElementById("coinBalance").textContent = coinBalance; // Kontostand aktualisieren
            updateChart(); // Diagramm aktualisieren
        }

        function login() {
            const username = document.getElementById("username").value;
            const password = document.getElementById("adminPassword").value;
            const adminPanel = document.getElementById("adminPanel");

            if (username === "Dualis" && password === "28102007") {
                adminPanel.style.display = "block";
                document.getElementById("employee-access").style.display = "none"; // Mitarbeiterzugang verstecken
            } else {
                alert("Ungültige Anmeldeinformationen!");
            }
        }

        function addCode() {
            const newCodeInput = document.getElementById("newCodeInput").value;
            const adminMessage = document.getElementById("adminMessage");
            if (newCodeInput) {
                codes.push(newCodeInput);
                adminMessage.textContent = "Neuer Code hinzugefügt!";
                adminMessage.className = ""; // Fehlerklasse zurücksetzen
                document.getElementById("newCodeInput").value = ""; // Eingabefeld leeren
            } else {
                adminMessage.textContent = "Bitte geben Sie einen Code ein!";
                adminMessage.className = "error-message"; // Fehlerklasse hinzufügen
            }
            setTimeout(() => {
                adminMessage.textContent = ""; // Nachricht nach 3 Sekunden löschen
            }, 3000);
        }

        function sendCoins() {
            // Logik zum Versenden von Coins
            const recipient = document.getElementById("recipient").value;
            const amount = parseInt(document.getElementById("amount").value);

            if (recipient && amount > 0 && amount <= coinBalance) {
                coinBalance -= amount; // Coins abziehen
                updateUI(); // UI aktualisieren
                alert(`Coins erfolgreich an ${recipient} gesendet!`);
            } else {
                alert("Ungültige Eingaben für die Überweisung!");
            }
        }

        function withdrawCoins() {
            // Logik zum Abheben von Coins (kann weiter implementiert werden)
        }

        function animateCoin() {
            // Animation für Coin hinzufügen
            const coinAnimation = document.createElement("div");
            coinAnimation.textContent = "💰";
            coinAnimation.style.position = "absolute";
            coinAnimation.style.fontSize = "30px";
            coinAnimation.style.animation = "bounce 0.5s infinite"; // Animation
            document.body.appendChild(coinAnimation);
            setTimeout(() => {
                document.body.removeChild(coinAnimation);
            }, 1000);
        }

        function updateChart() {
            const ctx = document.getElementById('chart').getContext('2d');
            if (window.myChart) {
                window.myChart.destroy();
            }

            window.myChart = new Chart(ctx, {
                type: 'line', // Liniendiagramm
                data: {
                    labels: Array.from({ length: 10 }, (_, i) => i + 1),
                    datasets: [{
                        label: 'Coin Preis',
                        data: [coinPrice, coinPrice * 1.05, coinPrice * 1.1, coinPrice * 1.15, coinPrice * 1.2, coinPrice * 1.25, coinPrice * 1.3, coinPrice * 1.35, coinPrice * 1.4, coinPrice * 1.45],
                        borderColor: 'green',
                        borderWidth: 2,
                        fill: false,
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
